# Data Directory Structure - Final Design

## Overview

The data directory clearly separates **simulation** and **experimental** data into two independent modules.

```
data/
├── simulation/              # Simulation data (all simulation-related files)
│   ├── presets/            # Built-in presets (system-provided, read-only)
│   │   ├── molecules/      # Preset molecules (e.g., glucose, pyruvate)
│   │   └── parameters/     # Preset simulation parameters
│   │
│   ├── user_save/          # User-saved data (user-created, writable)
│   │   ├── molecules/      # Custom molecule definitions
│   │   └── parameters/     # Custom simulation parameters
│   │
│   └── output/             # Simulation results (generated output)
│       └── spectrum/       # Exported simulation spectra
│
└── experimental/           # Experimental data (all experiment-related files)
    ├── raw/                # Raw data from instruments (read from instruments)
    └── processed/          # Processed data (generated by processing module)
```

## Design Principles

### 1. Clear Separation
- **Simulation**: Everything related to computational simulation
- **Experimental**: Everything related to real experimental data
- No mixing or confusion between the two

### 2. Data Flow

**Simulation Module:**
```
Presets/User Save → Simulation Engine → Output Spectrum
```

**Experimental Module:**
```
Raw Data → Processing Algorithms → Processed Data
```

### 3. Independence
- Each module has its own data directories
- Each module has its own workflows
- Modules can interact (e.g., compare results) but data storage is separate

### 4. Backward Compatibility

Legacy root directories will be deprecated but supported during transition:

| Legacy Location | New Location | Status |
|----------------|--------------|--------|
| `presets/` | `data/simulation/presets/` | Migrate |
| `user_save/` | `data/simulation/user_save/` | Migrate |
| `spectrum/` | `data/simulation/output/spectrum/` | Migrate |

Code will support reading from both old and new locations.

## Migration Strategy

### Phase 1: Dual Support (Current)
- New directories created
- Code reads from both old and new locations
- New saves go to new locations

### Phase 2: Migration Tools
- Provide tools to migrate existing data
- User-friendly migration wizard
- Verify data integrity after migration

### Phase 3: Deprecation
- Show warnings when using legacy directories
- Encourage users to migrate
- Documentation updated

### Phase 4: Removal
- Remove legacy directories (future major version)
- Clean codebase
- New installations only use new structure

## Benefits

1. **Clarity**: Obvious separation between simulation and experiment
2. **Organization**: Logical grouping of related data
3. **Scalability**: Easy to add new data types
4. **Maintainability**: Clear ownership of each directory
5. **Independence**: Modules don't interfere with each other

## Examples

### Simulation Workflow
```python
# Load preset molecule
molecule = load_molecule("data/simulation/presets/molecules/glucose.json")

# Run simulation
result = simulate(molecule, params)

# Save to output
save_spectrum(result, "data/simulation/output/spectrum/glucose_sim_001/")
```

### Experimental Workflow
```python
# Load raw data
raw_data = load_raw("data/experimental/raw/2025-10-10_sample1/fid.txt")

# Process
processed = process_fid(raw_data, filters=..., baseline=...)

# Save processed
save_processed(processed, "data/experimental/processed/2025-10-10_sample1_processed/")
```

### Comparison Workflow
```python
# Load both
sim_spectrum = load_simulation("data/simulation/output/spectrum/glucose_sim_001/")
exp_spectrum = load_processed("data/experimental/processed/glucose_exp_001/")

# Compare
compare_spectra(sim_spectrum, exp_spectrum)
```
